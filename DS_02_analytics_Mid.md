# Data Scientist. Аналитика. Начальный уровень
# Оглавление
* Module 1. Язык программирования R (часть 1)
* Module 3. Язык программирования R (часть 3) 
* Module 5. AB-тестирование. Часть 1
* Module 6. AB-тестирование. Часть 2
* Module 7. AB-тестирование. Мастер класс
* Module 8. Performance metrics

# Module 1. Язык программирования R (часть 1)
Работать с R-studio можно через docker:
* Запускается rstudio и доступно на порту 8787.
* привязывается папка, которая у вас в терминале.
* Запускается контейнер с root доступом.

```bash
docker run -d -p 8787:8787 --name studio -v ${pwd}:/home/rstudio -e ROOT=TRUE -e PASSWORD="rstudio" rocker/rstudio
```

Для подключения к терминалу контейнера можно использовать следующую команду:
```bash
# Потребуется для доустановки libxml2
docker exec -ti studio bash
```

# Module 3. Язык программирования R (часть 3) 

Возможно у вас будут проблемы с установкой библиотеки. Можно попробовать следующие:
```R
update.packages(repos='http://cran.rstudio.com/', ask=FALSE, checkBuilt=TRUE)
install.packages("tidyverse", dependencies = TRUE)
tidyverse_update()
```

Для Linux
```bash
sudo apt-get install libxml2
```

# Module 5. AB-тестирование. Часть 1
В python нужно будет загружать данные из csv, можно обойтись без pandas
```python
# Читаем текстовый файл
    # Указываем разделитель - запятую
    # Пропускаем заголовок
    # Читаем 2 столбец - OLD, NEW - третий столбец
OLD = np.genfromtxt("conversion.csv", delimiter=",", skip_header=1, usecols=1)
```

**Про p-value:** - более подробно [в статье](https://towardsdatascience.com/p-values-explained-by-data-scientist-f40a746cfc8)
* $H_0$ - дизайн интернет магазина, где расположена кнопка слева или справа от суммы покупки **НЕ** влияет на конверсию.
* Считаем `p-value`, уровень доверия установлен на `5%`.
  * `уровень доверия` - существует 5% вероятность, что кнопка на самом деле влияет на конверсию. Этот уровень задёт веротяность для совершения ошибки первого рода - отвергнуть $H_0$, если она верна.
  * `p-value` - показывает веротяность, что $H_0$ верна т.е. вероятность события в мире, где $H_0$ верна:
      * В Видео 6.5 в конце расчёт идёт как `(sum(diff_center > (p_new - p_old))` - считает **число** случаев, в которых `p-value` больше рассчитанной доли. Если ноль случаев - то гипотезу нужно отвергнуть. Это не значит что `p-value` нулевое.
      * В других видео идёт рассмотрение значений `p-value` - которые лежат от 0 до 1. Это площадь под кривой - от линии `+\- (p_new - p_old)`
    * Таким образом:
      * Если **количество значений** - 0, то гипотезу $H_0$ нужно отвергать или Если **p-value** - площадь меньше 0.05, то гипотезу $H_0$ отвергаем. 
        * Веротяность, что $H_0$ верна `0.02`, а вероятность допустить ошибку первого рода (отвергнуть $H_0$, когда она верна) 0.05.
      * Если **p-value** - площадь больше 0.05, то $H_0$ НЕ отвергаем, т.к. вероятность что событие произойдет выше, чем возможность допустит ошибку.


# Module 6. AB-тестирование. Часть 2
В python в текущей версии библиотеки есть выбор какую гипотезу тестируем
```python
# The alternative hypothesis can be either two-sided or one of the onesided tests, smaller means that the alternative hypothesis is ``prop < value`` and larger means ``prop > value``.
# In the two sample test, smaller means that the alternative hypothesis is ``p1 < p2`` and larger means ``p1 > p2`` where ``p1`` is the proportion of the first sample and ``p2`` of the second one.

z_stat, p_value = proportions_ztest(count, nobs, alternative='smaller')
```

Про центрирование, возможно Алла решила упростить материал и по этому центрировала, просто вычитая среднее. Возможно логичнее сделать центрирование через расчёт $z = \frac{\bar{x} - \mu_0}{\sigma}$. Приводим полученные доли в размер стандартного нормального распределения, тогда можно отсекать нужный нам участок через $1.96 \sigma$. В варианте Аллы, отсекать участок p-value вероятно нужно через перцентиль `97.5%`.

[Сатья с доп. пояснениями про таблицы и критерии](https://www.sheffield.ac.uk/polopoly_fs/1.43999!/file/tutorial-10-reading-tables.pdf)

# Module 7. AB-тестирование. Мастер класс.

Просмотрев видео, возможно у вас возникнет вопрос, а что собственно с этим делать?  Я поступил следующим образом:
* Разобрал код спикера (дописал комментарии, заголовки и т.д.) и в целом посмотрел на алгоритм AB-теста, который использует спикер. Нашёл интересным (код):
  * [конструкцию `df.query('A > B')`](https://pandas.pydata.org/pandas-docs/stable/reference/api/pandas.DataFrame.query.html)
  * [конструкцию `~np.isnan(x.order_id)`](https://blog.finxter.com/tilde-python/) - быстрое преобразование True <-> False.

* В модуле одно практическое задание (грузоперевозки), одно сквозное задание (фитнес), одно домашнее задание (ювелирный магазин):
  * Грузоперевозки (практика 1)
    * Нужно использовать [калькулятор](https://mindbox.ru/ab-test-calculator/)
    * Какая формула зашита в него неизвестно мне удалось обнаружить $n = 2 * (Z_{\alpha/2} + Z_{\beta})^2 / (\frac{d}{SD})^2$, но она не подходит (вероятно). Формула взята из медицинской [статьи.](https://cyberleninka.ru/article/n/planiruem-klinicheskoe-issledovanie-vopros-1-kak-opredelit-neobhodimyy-obem-vyborki/viewer)
    * $1 - \beta$ - мощность - визуальное представление [Understanding Statistical Power and Significance Testing](https://rpsychologist.com/d3/nhst/). Коэф. $\beta$ отвечает за вероятнсоть допустить ошибку второго рода.
  * Сквозное задание (все уроки) кейс - "Фитнес" - задачи:
    * **Практика 1**
      * рассчитать длительность эксперимента.
      * Запомнить, что дальше (практика 2 и 3) исследуются две метрики:
        * `конверсия в заказ`,
        * `стоимость заказа`.
    * **Практика 2 - данные `trener_prices.xlsx`**
      * Достаточно ли в тесте данных? Сколько времени шел тест?
        * посчитать по файлу и сравнить с расчётами в практике 1.
      * Отличается ли фактическая длительность теста от рассчитанной?
        * вспомнить что было в практике 1 и сравнить с данными что есть.
      * Как ведет себя график p-value по дням?
        * определить гипотезы на основе метрики - `конверсия в заказ`.
        * построить по аналогии с тем, что было в мастер-классе график изменения `p-value`.
      * Что можете сказать об изменении `конверсии в заказ`?
        * сделать вывод по аналогии с тем, что было в мастер-классе.
    * **Практика 3 - данные `trener_prices.xlsx`**
      * Нужно изучить метрику `стоимость заказа`
        * Добавлены уточнения про `payed_status=30 и price>0`, являются оплаченными.
      * Ответить на вопросы (по аналогии с `видео 7.3`):
        * Как распределена стоимость заказов?
        * Как изменилась стоимость заказа в Б варианте?
        * Значимы ли эти изменения?
        * Как вы оценивали значимость?
        * Почему выбрали такой метод?
  * Домашнее задание - «Ювелирный»:
    * Выдвинуть гипотезы.
    * Сделать bootstrap.
    * Построить визуализации.
    * Сделать выводы.

# Module 8. Performance metrics

Просмотрев видео, возможно у вас возникнет вопрос, а что собственно с этим делать? А после поиска по чату в телеграм, вы увидели ещё 2-4 таких же вопроса.

В целом работа сводится к:
* После видео 8.1 по `dataset-1.xlsx` - рассчитать (с разбивкой на **месяцы**):
  * Количество сессий (визитов)
  * MAU - Mounthly active users
  * DAU - Daily Active Users
  * Revenue - сумма дохода за месяц?
  * ARPU - Average revenue per user
  * ARPPU - Average revenue per paying user
  * Session / user
  * Количество целевых действий
* После видео 8.3 по `dataset-2.xlsx`:
  * Проверить корреляцию по метрикам (матрица корреляций).
  * Построить пирамиду метрик, можно текстом markdown оформить.
* После 8.5 по `Домашнее задание.xls`
  * Выявить метрики больше всего влияющие на доход - матрица корреляций.
  * Построить пирамиду метрик, можно текстом.

